<!DOCTYPE HTML>
<html lang>
<head>
<!-- Generated by javadoc (17) on Tue Nov 11 16:23:17 UTC 2025 -->
<title>GTSurfaceTension (NeqSim 3.1.0 API)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="dc.created" content="2025-11-11">
<meta name="description" content="declaration: package: neqsim.physicalproperties.interfaceproperties.surfacetension, class: GTSurfaceTension">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-3.7.1.min.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var evenRowColor = "even-row-color";
var oddRowColor = "odd-row-color";
var tableTab = "table-tab";
var activeTableTab = "active-table-tab";
var pathtoroot = "../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top">
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/GTSurfaceTension.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
</ul>
</div>
<div class="sub-nav">
<div>
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field-summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor-summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li><a href="#field-detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor-detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><label for="search-input">SEARCH:</label>
<input type="text" id="search-input" value="search" disabled="disabled">
<input type="reset" id="reset-button" value="reset" disabled="disabled">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">neqsim.physicalproperties.interfaceproperties.surfacetension</a></div>
<h1 title="Class GTSurfaceTension" class="title">Class GTSurfaceTension</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance"><a href="../InterfaceProperties.html" title="class in neqsim.physicalproperties.interfaceproperties">neqsim.physicalproperties.interfaceproperties.InterfaceProperties</a>
<div class="inheritance"><a href="SurfaceTension.html" title="class in neqsim.physicalproperties.interfaceproperties.surfacetension">neqsim.physicalproperties.interfaceproperties.surfacetension.SurfaceTension</a>
<div class="inheritance">neqsim.physicalproperties.interfaceproperties.surfacetension.GTSurfaceTension</div>
</div>
</div>
</div>
<section class="class-description" id="class-description">
<dl class="notes">
<dt>All Implemented Interfaces:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/Serializable.html" title="class or interface in java.io" class="external-link">Serializable</a></code>, <code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Cloneable.html" title="class or interface in java.lang" class="external-link">Cloneable</a></code>, <code><a href="../InterphasePropertiesInterface.html" title="interface in neqsim.physicalproperties.interfaceproperties">InterphasePropertiesInterface</a></code>, <code><a href="SurfaceTensionInterface.html" title="interface in neqsim.physicalproperties.interfaceproperties.surfacetension">SurfaceTensionInterface</a></code></dd>
</dl>
<hr>
<div class="type-signature"><span class="modifiers">public class </span><span class="element-name type-name-label">GTSurfaceTension</span>
<span class="extends-implements">extends <a href="SurfaceTension.html" title="class in neqsim.physicalproperties.interfaceproperties.surfacetension">SurfaceTension</a></span></div>
<div class="block"><p>
 GTSurfaceTension class. Calculates the surfacetension using the Gradient Theory for mixtures. The
 method assumes the number of components to be two or more, and that the species set is equal and
 in the same component order for both phases.

 Near a fluid-fluid interface, we consider the variation of densities of chemical species,
 \f$\boldsymbol{n}(z)\f$, as function of position, \f$z\f$, where element \f$k\f$ of the vector
 \f$\boldsymbol{n}(z)\f$ is the number density of chemical species \f$k\f$ in the mixture. The
 surface tension is a functional of these densities as explained below.

 The density profiles near the interface are such that the total Helmholz energy of the system is
 minimized. The effect of spatial density variations on the Helmholz energy is approximated by a
 second order Taylor series expansion around the homogeneous fluid of the same composition.

 \f{equation}{ H=\int_{-\infty}^{\infty} h \, dz=\int_{-\infty}^{\infty} \left( h_0 +
 \frac{1}{2}\boldsymbol{n_z}^T \boldsymbol{C} \boldsymbol{n_z} \right) dz \f}

 where \f$z\f$ is the spatial coordinate normal to the interface, \f$h_0\f$ is the Helmholz energy
 of the homogeneous fluid, \f$\boldsymbol{n_z}=\frac{d\boldsymbol{n}}{dz}\f$ is the local density
 gradient and the matrix of influence parameters \f$\boldsymbol{C}\f$ is the hessian of \f$h\f$
 with respect to \f$\boldsymbol{n_z}\f$. The influence parameters, \f$\boldsymbol{C}\f$, are
 normally assumed to be very weak functions of composition, often taken as constant through the
 interface.

 The integral is at its minimum when the densities satisfy the Euler-Lagrange equation

 \f{equation}{ \boldsymbol{C}\frac{d^2\boldsymbol{n}}{dz^2} = \mu_0 \left( \boldsymbol{n} \right)
 - \mu_{\infty} \equiv \Delta \mu \left( \boldsymbol{n} \right) \f}

 where \f$\mu_0\f$ is the chemical potential of the homogeneous fluid and \f$\mu_{\infty}\f$ is
 the chemical potential far from the interface (on either side, as the two fluids in contact are
 assumed to be at equilibrium). Having solved equation for the density profiles,
 \f$\boldsymbol{n}\left(z\right)\f$, the surface tension can be calculated from: \f{equation}{
 \sigma = \int_{-\infty}^{\infty} \boldsymbol{n_z}^T \boldsymbol{C} \boldsymbol{n_z} \, dz \f}

 The class uses two different methods based on the value of this.useFullGT. If this variable is
 set to 0, the surface tension is calculated by solving set of differential algebraic equations
 using the component density of the highest boiling component in the mixture as the integration
 variable. This method can only be used if the component density varies monotonically over the
 interface and the binary interaction parameter for the influence parameter is such that

 \f{equation}{ \begin{cases} \beta_{ij} = 1 &amp; i = j\\ \beta_{ij} = 0 &amp; i\neq j \end{cases}
 \f}

 If these conditions are satisfied, this method is robust and has an acceptable numerical cost
 (order of seconds for calculation).

 For the general case, where the monotonicity can not be guaranteed or where \f$\beta_{ij}\f$ is
 nonzero for \f$i\neq j\f$ the full set of equations for the gradient theory must solved in the
 domain of the interface thickness. This is significantly more numerically intensive but handles
 the general case. To calculate the surface tension by this method, set the variable
 this.useFullGT=1
 </p></div>
<dl class="notes">
<dt>Version:</dt>
<dd>$Id: $Id</dd>
<dt>Author:</dt>
<dd>Olaf Trygve Berglihn olaf.trygve.berglihn@sintef.no, John C. Morud john.c.morud@sintef.no</dd>
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../../serialized-form.html#neqsim.physicalproperties.interfaceproperties.surfacetension.GTSurfaceTension">Serialized Form</a></li>
</ul>
</dd>
</dl>
</section>
<section class="summary">
<ul class="summary-list">
<!-- =========== FIELD SUMMARY =========== -->
<li>
<section class="field-summary" id="field-summary">
<h2>Field Summary</h2>
<div class="caption"><span>Fields</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Field</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>private static final long</code></div>
<div class="col-second even-row-color"><code><a href="#serialVersionUID" class="member-name-link">serialVersionUID</a></code></div>
<div class="col-last even-row-color">
<div class="block">Serialization version UID.</div>
</div>
<div class="col-first odd-row-color"><code>(package private) int</code></div>
<div class="col-second odd-row-color"><code><a href="#useFullGT" class="member-name-link">useFullGT</a></code></div>
<div class="col-last odd-row-color">&nbsp;</div>
</div>
<div class="inherited-list">
<h3 id="fields-inherited-from-class-neqsim.physicalproperties.interfaceproperties.surfacetension.SurfaceTension">Fields inherited from class&nbsp;neqsim.physicalproperties.interfaceproperties.surfacetension.<a href="SurfaceTension.html" title="class in neqsim.physicalproperties.interfaceproperties.surfacetension">SurfaceTension</a></h3>
<code><a href="SurfaceTension.html#system">system</a></code></div>
</section>
</li>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li>
<section class="constructor-summary" id="constructor-summary">
<h2>Constructor Summary</h2>
<div class="caption"><span>Constructors</span></div>
<div class="summary-table two-column-summary">
<div class="table-header col-first">Constructor</div>
<div class="table-header col-last">Description</div>
<div class="col-constructor-name even-row-color"><code><a href="#%3Cinit%3E()" class="member-name-link">GTSurfaceTension</a>()</code></div>
<div class="col-last even-row-color">
<div class="block">
 Constructor for GTSurfaceTension.</div>
</div>
<div class="col-constructor-name odd-row-color"><code><a href="#%3Cinit%3E(neqsim.thermo.system.SystemInterface)" class="member-name-link">GTSurfaceTension</a><wbr>(<a href="../../../thermo/system/SystemInterface.html" title="interface in neqsim.thermo.system">SystemInterface</a>&nbsp;system)</code></div>
<div class="col-last odd-row-color">
<div class="block">
 Constructor for GTSurfaceTension.</div>
</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab1" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab1', 3)" class="table-tab">Static Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel" aria-labelledby="method-summary-table-tab0">
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>double</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#calcSurfaceTension(int,int)" class="member-name-link">calcSurfaceTension</a><wbr>(int&nbsp;interface1,
 int&nbsp;interface2)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">
 Calculates the surface tension between two phases.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static double</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#solveFullDensityProfile(neqsim.thermo.system.SystemInterface,int,int)" class="member-name-link">solveFullDensityProfile</a><wbr>(<a href="../../../thermo/system/SystemInterface.html" title="interface in neqsim.thermo.system">SystemInterface</a>&nbsp;system,
 int&nbsp;interface1,
 int&nbsp;interface2)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">
 solveFullDensityProfile.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static double</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#solveWithRefcomp(neqsim.thermo.system.SystemInterface,int,int,int)" class="member-name-link">solveWithRefcomp</a><wbr>(<a href="../../../thermo/system/SystemInterface.html" title="interface in neqsim.thermo.system">SystemInterface</a>&nbsp;system,
 int&nbsp;interface1,
 int&nbsp;interface2,
 int&nbsp;refcompIndex)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">
 solveWithRefcomp.</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-neqsim.physicalproperties.interfaceproperties.surfacetension.SurfaceTension">Methods inherited from class&nbsp;neqsim.physicalproperties.interfaceproperties.surfacetension.<a href="SurfaceTension.html" title="class in neqsim.physicalproperties.interfaceproperties.surfacetension">SurfaceTension</a></h3>
<code><a href="SurfaceTension.html#calcPureComponentSurfaceTension(int)">calcPureComponentSurfaceTension</a>, <a href="SurfaceTension.html#getComponentWithHighestBoilingpoint()">getComponentWithHighestBoilingpoint</a></code></div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-neqsim.physicalproperties.interfaceproperties.InterfaceProperties">Methods inherited from class&nbsp;neqsim.physicalproperties.interfaceproperties.<a href="../InterfaceProperties.html" title="class in neqsim.physicalproperties.interfaceproperties">InterfaceProperties</a></h3>
<code><a href="../InterfaceProperties.html#calcAdsorption()">calcAdsorption</a>, <a href="../InterfaceProperties.html#clone()">clone</a>, <a href="../InterfaceProperties.html#getAdsorptionCalc()">getAdsorptionCalc</a>, <a href="../InterfaceProperties.html#getAdsorptionCalc(java.lang.String)">getAdsorptionCalc</a>, <a href="../InterfaceProperties.html#getInterfacialTensionModel()">getInterfacialTensionModel</a>, <a href="../InterfaceProperties.html#getSurfaceTension(int,int)">getSurfaceTension</a>, <a href="../InterfaceProperties.html#getSurfaceTension(int,int,java.lang.String)">getSurfaceTension</a>, <a href="../InterfaceProperties.html#getSurfaceTensionModel(int)">getSurfaceTensionModel</a>, <a href="../InterfaceProperties.html#init()">init</a>, <a href="../InterfaceProperties.html#init(neqsim.thermo.system.SystemInterface)">init</a>, <a href="../InterfaceProperties.html#initAdsorption()">initAdsorption</a>, <a href="../InterfaceProperties.html#setAdsorptionCalc(neqsim.physicalproperties.interfaceproperties.solidadsorption.AdsorptionInterface%5B%5D)">setAdsorptionCalc</a>, <a href="../InterfaceProperties.html#setInterfacialTensionModel(int)">setInterfacialTensionModel</a>, <a href="../InterfaceProperties.html#setInterfacialTensionModel(java.lang.String,java.lang.String,java.lang.String)">setInterfacialTensionModel</a>, <a href="../InterfaceProperties.html#setSolidAdsorbentMaterial(java.lang.String)">setSolidAdsorbentMaterial</a></code></div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#equals(java.lang.Object)" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#finalize()" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#getClass()" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#hashCode()" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#notify()" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#notifyAll()" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#toString()" title="class or interface in java.lang" class="external-link">toString</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#wait()" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#wait(long)" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#wait(long,int)" title="class or interface in java.lang" class="external-link">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ FIELD DETAIL =========== -->
<li>
<section class="field-details" id="field-detail">
<h2>Field Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="serialVersionUID">
<h3>serialVersionUID</h3>
<div class="member-signature"><span class="modifiers">private static final</span>&nbsp;<span class="return-type">long</span>&nbsp;<span class="element-name">serialVersionUID</span></div>
<div class="block">Serialization version UID.</div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../../constant-values.html#neqsim.physicalproperties.interfaceproperties.surfacetension.GTSurfaceTension.serialVersionUID">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="useFullGT">
<h3>useFullGT</h3>
<div class="member-signature"><span class="return-type">int</span>&nbsp;<span class="element-name">useFullGT</span></div>
</section>
</li>
</ul>
</section>
</li>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li>
<section class="constructor-details" id="constructor-detail">
<h2>Constructor Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="&lt;init&gt;()">
<h3>GTSurfaceTension</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name">GTSurfaceTension</span>()</div>
<div class="block"><p>
 Constructor for GTSurfaceTension.
 </p></div>
</section>
</li>
<li>
<section class="detail" id="&lt;init&gt;(neqsim.thermo.system.SystemInterface)">
<h3>GTSurfaceTension</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name">GTSurfaceTension</span><wbr><span class="parameters">(<a href="../../../thermo/system/SystemInterface.html" title="interface in neqsim.thermo.system">SystemInterface</a>&nbsp;system)</span></div>
<div class="block"><p>
 Constructor for GTSurfaceTension.
 </p></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>system</code> - a <a href="../../../thermo/system/SystemInterface.html" title="interface in neqsim.thermo.system"><code>SystemInterface</code></a> object</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="calcSurfaceTension(int,int)">
<h3>calcSurfaceTension</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name">calcSurfaceTension</span><wbr><span class="parameters">(int&nbsp;interface1,
 int&nbsp;interface2)</span></div>
<div class="block"><p>
 Calculates the surface tension between two phases.
 </p></div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="SurfaceTensionInterface.html#calcSurfaceTension(int,int)">calcSurfaceTension</a></code>&nbsp;in interface&nbsp;<code><a href="SurfaceTensionInterface.html" title="interface in neqsim.physicalproperties.interfaceproperties.surfacetension">SurfaceTensionInterface</a></code></dd>
<dt>Overrides:</dt>
<dd><code><a href="SurfaceTension.html#calcSurfaceTension(int,int)">calcSurfaceTension</a></code>&nbsp;in class&nbsp;<code><a href="SurfaceTension.html" title="class in neqsim.physicalproperties.interfaceproperties.surfacetension">SurfaceTension</a></code></dd>
<dt>Parameters:</dt>
<dd><code>interface1</code> - Phase index 1</dd>
<dd><code>interface2</code> - Phase index 2</dd>
<dt>Returns:</dt>
<dd>Surface tension in N/m</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="solveWithRefcomp(neqsim.thermo.system.SystemInterface,int,int,int)">
<h3>solveWithRefcomp</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name">solveWithRefcomp</span><wbr><span class="parameters">(<a href="../../../thermo/system/SystemInterface.html" title="interface in neqsim.thermo.system">SystemInterface</a>&nbsp;system,
 int&nbsp;interface1,
 int&nbsp;interface2,
 int&nbsp;refcompIndex)</span></div>
<div class="block"><p>
 solveWithRefcomp. Solve for the surface tension by integration in a reference component density
 for cases with no binary interaction parameter in the influcence parameter.

 The pertinent equations for calculating the interfacial tension according to Gradient Theory
 can be represented by the system of equations below, providing that the reference component
 number density varies monotonically through the interface, and that the joint influence
 parameter \f$c_{ij}\f$ can be described by a quadratic mixing rule, without a binary
 interaction parameter. The transformation of the integration variable from spacial position in
 the interface to the number density of a reference component simplifies the differential
 algebraic problem to an initial value problem with finite bounds. It is usually not known in
 advance whether the chosen reference component number density varies monotonically over the
 interface, and caution should be used in interpreting the results.

 \f{gather}{ \sigma = \int_{\rho_\text{ref}^\text{vap}}^{\rho_\text{ref}^\text{liq}}
 \sqrt{2\Delta\Omega(\boldsymbol{\rho})\sum_i\sum_j c_{ij}
 \frac{\partial\rho_i}{\partial\rho_\text{ref}} \frac{\partial\rho_j}{\partial\rho_\text{ref}}}
 \mathrm{d}\rho_\text{ref}\\ 0 = \sqrt{c_i}\left(\mu_\text{ref}^\text{eq}
 -\mu_\text{ref}(\boldsymbol{\rho})\right) -\sqrt{c_\text{ref}}
 \left(\mu_i^\text{eq}-\mu_i(\boldsymbol{\rho})\right)\\ c_i = \left(A_it_i +
 B_i\right)a_ib_i^{\frac{2}{3}}\\ t_i = 1-T/T_{C,i}\\ A_i = \frac{1}{\xi_1 + \xi_2\omega_i}\\
 B_i = \frac{1}{\xi_3 + \xi_4\omega_i}\\ c_{ij} = \sqrt{c_ic_j} \f}

 Here \f$\sigma\f$ is the interfacial tension, \f$\rho\f$ is the number density, \f$\Omega\f$ is
 the grand canonical potential, \f$\mu_i\f$ is the chemical potential of component, \f$i\f$, and
 \f$c_i\f$ and \f$c_{ij}\f$ is the influence and cross-influence parameter. The parameters
 \f$\xi\f$ must be fitted to the equation of state used.

 Since the monotonicity of a reference component in general can not be guaranteed, a more
 general and safer approach would be to solve the system in the spacial domain. This implies
 solving a boundary value problem with infinite bounds. Although asymptotic arguments leads to
 simplifications, solving this problem induces a higher numerical cost and complexity.

 This method solves the surface tension integral using a reference component density as the
 integration variable as described above. The equilibrium relations are solved as a set of
 algebraic equations for each evaluation of the differential. The resulting ordinary
 differential equation is integrated with a non-stiff Runge-Kutta class Dormand Prince method,
 similar to the MATLAB routine ode45.
 </p></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>system</code> - NeqSIM system interface</dd>
<dd><code>interface1</code> - Index of the phase to consider for the surface</dd>
<dd><code>interface2</code> - Index of the phase to consider for the surface</dd>
<dd><code>refcompIndex</code> - Index of the reference component to use when using a component density as
        integration variable.</dd>
<dt>Returns:</dt>
<dd>Surface tension in units of N/m.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="solveFullDensityProfile(neqsim.thermo.system.SystemInterface,int,int)">
<h3>solveFullDensityProfile</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name">solveFullDensityProfile</span><wbr><span class="parameters">(<a href="../../../thermo/system/SystemInterface.html" title="interface in neqsim.thermo.system">SystemInterface</a>&nbsp;system,
 int&nbsp;interface1,
 int&nbsp;interface2)</span></div>
<div class="block"><p>
 solveFullDensityProfile. Calculate the surface tension for the general case by integration of
 the component density profiles.

 This method can be used in the general case, including when binary interaction influence
 parameters \f$\beta_{ij}\f$ are nonzero.

 On the top level, we solve the Euler-Lagrange equation with Newtons method. Consider solving
 Equation for \f$\delta\mu\f$ as a Dirichlet problem on a finite domain \f$-L &lt; z &lt; L\f$
 around the interface. The distance \f$L\f$ should be large enough that it does not disturb the
 results. The boundary conditions are the homogeneous densities of the two fluids in contact, as
 calculated by a flash calculation.

 We approximate the solution on a equi-spaced grid with \f$2^N+1\f$ points where \f$N\f$ is an
 integer. Using a Finite Difference approximation, the equation for \f$\delta\mu\f$ can then be
 written as an equation system for the internal grid points, \f$i=2,3,...,2^N\f$:

 \f{equation}{ \mathbf{0}=\mathbf{F}\left( \mathbf{n}_i \right) \equiv \Delta \mu \left(
 \mathbf{n}_i \right) - \mathbf{C} \frac{\mathbf{n}_{i-1}
 -2\mathbf{n}_i+\mathbf{n}_{i+1}}{\Delta z^2}, \quad i=2,3,...,2^N \f}

 Applying Newtons method on this equation yields the iteration formula for the Newton step:
 \f{eqnarray}{ \mathbf{J}_i\Delta \mathbf{n}_i - \mathbf{C} \frac{\Delta \mathbf{n}_{i-1}
 -2\Delta \mathbf{n}_i +\Delta \mathbf{n}_{i+1}}{\Delta z^2} &amp;=&amp; - \mathbf{F}_i\\
 \mathbf{n}_i &amp;:=&amp; \mathbf{n}_i + \beta \Delta \mathbf{n}_i \f} where
 \f$\mathbf{J}=\frac{\partial \Delta \mu}{\partial \mathbf{n}_i}\f$ is a Jacobian matrix and
 \f$\mathbf{F}_i=\mathbf{F}\left( \mathbf{n}_i \right)\f$ is the residual. \f$\beta \le 1\f$ is
 a damping factor. This is a block tridiagonal system that can be solved using a band solver or
 a sparse matrix solver.
 </p></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>system</code> - NeqSIM system interface</dd>
<dd><code>interface1</code> - Index of the phase to consider for the surface</dd>
<dd><code>interface2</code> - Index of the phase to consider for the surface</dd>
<dt>Returns:</dt>
<dd>Surface tension in units of N/m.</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small>Copyright &#169; 2025. All rights reserved.</small></p>
</footer>
</div>
</div>
</body>
</html>
